#include <stdio.h>
#include <stdlib.h>
#include <ECG-Autocorrelation-500Hz_inferencing.h>

// -------------------------------
// declaring variables and vectors
double        data[5000]   =   {
        0.06 ,  0.06 ,  0.06 ,  0.06 ,  0.06 ,  0.06 ,  0.068,  0.074,
        0.075,  0.075,  0.08 ,  0.085,  0.082,  0.081,  0.086,  0.09 ,
        0.09 ,  0.089,  0.092,  0.095,  0.095,  0.099,  0.103,  0.109,
        0.117,  0.12 ,  0.12 ,  0.117,  0.113,  0.109,  0.105,  0.101,
        0.1  ,  0.101,  0.099,  0.095,  0.094,  0.098,  0.101,  0.1  ,
        0.1  ,  0.104,  0.104,  0.094,  0.084,  0.08 ,  0.064,  0.049,
        0.043,  0.039,  0.03 ,  0.022,  0.016,  0.014,  0.016,  0.02 ,
        0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.012,  0.006,  0.004,
       -0.002, -0.01 , -0.018, -0.025, -0.021, -0.014, -0.015, -0.015,
       -0.015, -0.015, -0.015, -0.015, -0.019, -0.024, -0.025, -0.026,
       -0.03 , -0.034, -0.036, -0.033, -0.029, -0.03 , -0.037, -0.048,
       -0.047, -0.039, -0.04 , -0.041, -0.037, -0.035, -0.034, -0.03 ,
       -0.031, -0.024, -0.019, -0.021, -0.02 , -0.012, -0.007, -0.001,
        0.007,  0.01 ,  0.01 ,  0.01 ,  0.008,  0.005,  0.005,  0.006,
        0.002,  0.   , -0.001, -0.005, -0.005, -0.006, -0.001,  0.006,
        0.01 ,  0.018,  0.025,  0.023,  0.012,  0.005,  0.021,  0.03 ,
        0.015, -0.002,  0.   ,  0.001, -0.003, -0.006, -0.005, -0.005,
       -0.01 , -0.007, -0.004, -0.005, -0.005, -0.005, -0.008, -0.011,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.009, -0.011, -0.015, -0.011,
       -0.009, -0.01 , -0.01 , -0.01 , -0.014, -0.015, -0.015, -0.015,
       -0.015, -0.015, -0.014, -0.017, -0.02 , -0.015, -0.015, -0.015,
       -0.015, -0.016, -0.02 , -0.02 , -0.02 , -0.018, -0.015, -0.015,
       -0.015, -0.018, -0.021, -0.02 , -0.02 , -0.021, -0.016, -0.016,
       -0.021, -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.028,
       -0.031, -0.03 , -0.03 , -0.025, -0.003,  0.026,  0.021, -0.021,
       -0.045, -0.004,  0.044,  0.072,  0.107,  0.16 ,  0.186,  0.24 ,
        0.321,  0.399,  0.47 ,  0.523,  0.497,  0.45 ,  0.397,  0.31 ,
        0.252,  0.202,  0.146,  0.076,  0.   , -0.056, -0.116, -0.167,
       -0.206, -0.245, -0.259, -0.262, -0.27 , -0.283, -0.29 , -0.298,
       -0.305, -0.316, -0.327, -0.335, -0.347, -0.355, -0.352, -0.343,
       -0.335, -0.327, -0.319, -0.311, -0.303, -0.295, -0.286, -0.284,
       -0.269, -0.245, -0.23 , -0.206, -0.187, -0.171, -0.15 , -0.13 ,
       -0.114, -0.098, -0.081, -0.059, -0.045, -0.058, -0.056, -0.047,
       -0.044, -0.035, -0.026, -0.023, -0.013, -0.024, -0.06 , -0.028,
       -0.016, -0.02 , -0.013, -0.01 , -0.011, -0.006, -0.009, -0.023,
       -0.03 , -0.03 , -0.03 , -0.03 , -0.031, -0.035, -0.036, -0.031,
       -0.031, -0.036, -0.035, -0.035, -0.037, -0.029, -0.019, -0.02 ,
       -0.02 , -0.02 , -0.018, -0.014, -0.015, -0.016, -0.009, -0.002,
        0.   ,  0.   ,  0.   ,  0.   ,  0.   , -0.001,  0.   ,  0.017,
        0.019,  0.012,  0.01 ,  0.02 ,  0.038,  0.036,  0.044,  0.062,
        0.055,  0.054,  0.056,  0.053,  0.059,  0.08 ,  0.085,  0.085,
        0.085,  0.085,  0.085,  0.087,  0.105,  0.119,  0.12 ,  0.12 ,
        0.12 ,  0.119,  0.125,  0.138,  0.14 ,  0.132,  0.127,  0.122,
        0.113,  0.11 ,  0.117,  0.127,  0.132,  0.136,  0.14 ,  0.132,
        0.124,  0.116,  0.109,  0.105,  0.093,  0.082,  0.08 ,  0.079,
        0.075,  0.075,  0.071,  0.072,  0.075,  0.075,  0.089,  0.083,
        0.069,  0.064,  0.06 ,  0.05 ,  0.062,  0.087,  0.094,  0.08 ,
        0.068,  0.053,  0.038,  0.028,  0.02 ,  0.016,  0.013,  0.007,
        0.007,  0.02 ,  0.033,  0.04 ,  0.052,  0.06 ,  0.05 ,  0.041,
        0.037,  0.031,  0.024,  0.02 ,  0.012,  0.006,  0.005,  0.004,
        0.   ,  0.   , -0.002, -0.008, -0.01 , -0.01 , -0.014, -0.018,
       -0.007,  0.006,  0.   ,  0.   , -0.003, -0.006, -0.004, -0.005,
       -0.011,  0.003,  0.008, -0.001,  0.   , -0.003, -0.011, -0.018,
       -0.021, -0.025, -0.029, -0.03 , -0.032, -0.035, -0.035, -0.039,
       -0.041, -0.038, -0.034, -0.03 , -0.03 , -0.029, -0.033, -0.033,
       -0.025, -0.042, -0.042, -0.028, -0.018, -0.01 , -0.006,  0.   ,
        0.01 ,  0.015,  0.01 ,  0.006,  0.001,  0.   , -0.001, -0.005,
       -0.004, -0.011, -0.016, -0.015, -0.02 , -0.021, -0.014, -0.009,
       -0.01 , -0.01 , -0.012, -0.032, -0.056, -0.065, -0.06 , -0.056,
       -0.052, -0.05 , -0.05 , -0.045, -0.036, -0.035, -0.034, -0.029,
       -0.025, -0.025, -0.023, -0.017, -0.015, -0.015, -0.011, -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.014, -0.017, -0.024, -0.03 , -0.03 ,
       -0.038, -0.044, -0.044, -0.039, -0.035, -0.035, -0.032, -0.03 ,
       -0.03 , -0.025, -0.021, -0.02 , -0.02 , -0.019, -0.015, -0.01 ,
       -0.01 , -0.008, -0.005, -0.005, -0.004, -0.01 , -0.019, -0.027,
       -0.035, -0.039, -0.042, -0.048, -0.048, -0.035, -0.022, -0.015,
       -0.003,  0.015,  0.03 ,  0.04 ,  0.074,  0.128,  0.174,  0.21 ,
        0.269,  0.328,  0.397,  0.454,  0.465,  0.462,  0.411,  0.342,
        0.287,  0.225,  0.135,  0.039, -0.013, -0.03 , -0.055, -0.078,
       -0.114, -0.155, -0.187, -0.215, -0.245, -0.258, -0.263, -0.272,
       -0.28 , -0.284, -0.291, -0.297, -0.302, -0.31 , -0.318, -0.325,
       -0.337, -0.337, -0.31 , -0.288, -0.281, -0.279, -0.272, -0.255,
       -0.237, -0.239, -0.251, -0.246, -0.22 , -0.204, -0.184, -0.169,
       -0.145, -0.1  , -0.086, -0.079, -0.072, -0.069, -0.065, -0.062,
       -0.053, -0.051, -0.055, -0.05 , -0.052, -0.066, -0.066, -0.044,
       -0.025, -0.016, -0.015, -0.014, -0.009, -0.005, -0.005, -0.003,
        0.004,  0.012,  0.01 , -0.012, -0.011, -0.003, -0.006, -0.005,
       -0.001,  0.   ,  0.002,  0.005,  0.005,  0.009,  0.011,  0.009,
        0.011,  0.015,  0.019,  0.024,  0.025,  0.027,  0.035,  0.038,
        0.053,  0.06 ,  0.055,  0.06 ,  0.06 ,  0.06 ,  0.061,  0.059,
        0.05 ,  0.034,  0.024,  0.031,  0.042,  0.04 ,  0.038,  0.053,
        0.06 ,  0.055,  0.06 ,  0.065,  0.065,  0.066,  0.071,  0.075,
        0.074,  0.081,  0.088,  0.091,  0.095,  0.099,  0.106,  0.112,
        0.116,  0.12 ,  0.12 ,  0.123,  0.125,  0.126,  0.13 ,  0.122,
        0.119,  0.121,  0.118,  0.11 ,  0.109,  0.112,  0.105,  0.101,
        0.115,  0.123,  0.133,  0.148,  0.155,  0.145,  0.136,  0.132,
        0.127,  0.118,  0.11 ,  0.106,  0.103,  0.094,  0.083,  0.08 ,
        0.076,  0.072,  0.066,  0.059,  0.055,  0.051,  0.046,  0.045,
        0.044,  0.04 ,  0.04 ,  0.038,  0.033,  0.03 ,  0.03 ,  0.03 ,
        0.027,  0.024,  0.025,  0.025,  0.021,  0.019,  0.021,  0.018,
        0.01 ,  0.009,  0.011,  0.008,  0.005,  0.005,  0.001,  0.   ,
       -0.002, -0.005, -0.005, -0.005, -0.005, -0.006, -0.004,  0.   ,
       -0.004, -0.002,  0.   ,  0.002,  0.005, -0.017, -0.016, -0.009,
       -0.01 , -0.005, -0.001,  0.003,  0.006,  0.004,  0.   ,  0.004,
        0.002,  0.   , -0.001, -0.005,  0.   , -0.006,  0.006,  0.028,
        0.025,  0.024,  0.029,  0.046,  0.062,  0.06 ,  0.06 ,  0.061,
        0.058,  0.055,  0.06 ,  0.06 ,  0.059,  0.061,  0.057,  0.04 ,
        0.025,  0.003, -0.005,  0.   , -0.005, -0.005, -0.004, -0.007,
       -0.01 , -0.01 , -0.01 , -0.013, -0.016, -0.015, -0.015, -0.015,
       -0.018, -0.023, -0.025, -0.025, -0.029, -0.033, -0.036, -0.034,
       -0.03 , -0.024,  0.   ,  0.009, -0.011, -0.03 , -0.031, -0.03 ,
       -0.028, -0.025, -0.025, -0.025, -0.025, -0.023, -0.019, -0.015,
       -0.011, -0.01 , -0.008, -0.005, -0.005, -0.001,  0.   ,  0.017,
        0.046,  0.065,  0.103,  0.154,  0.206,  0.267,  0.335,  0.38 ,
        0.423,  0.446,  0.418,  0.355,  0.301,  0.225,  0.171,  0.139,
        0.07 , -0.014, -0.056, -0.074, -0.095, -0.115, -0.138, -0.169,
       -0.2  , -0.226, -0.245, -0.258, -0.264, -0.267, -0.28 , -0.3  ,
       -0.31 , -0.336, -0.341, -0.322, -0.315, -0.303, -0.294, -0.285,
       -0.271, -0.265, -0.278, -0.276, -0.266, -0.257, -0.245, -0.242,
       -0.191, -0.158, -0.156, -0.12 , -0.089, -0.08 , -0.08 , -0.08 ,
       -0.08 , -0.085, -0.078, -0.062, -0.054, -0.055, -0.055, -0.056,
       -0.05 , -0.046, -0.055, -0.056, -0.054, -0.056, -0.054, -0.045,
       -0.037, -0.031, -0.015, -0.015, -0.045, -0.042, -0.039, -0.039,
       -0.034, -0.035, -0.04 , -0.037, -0.035, -0.034, -0.03 , -0.032,
       -0.016,  0.001,  0.006,  0.015,  0.022,  0.001, -0.009,  0.001,
        0.   ,  0.004,  0.005,  0.007,  0.009,  0.01 ,  0.03 ,  0.04 ,
        0.042,  0.046,  0.045,  0.044,  0.048,  0.05 ,  0.051,  0.055,
        0.055,  0.055,  0.054,  0.065,  0.09 ,  0.091,  0.089,  0.09 ,
        0.09 ,  0.09 ,  0.09 ,  0.09 ,  0.089,  0.084,  0.08 ,  0.083,
        0.089,  0.088,  0.085,  0.09 ,  0.09 ,  0.093,  0.096,  0.095,
        0.095,  0.099,  0.1  ,  0.1  ,  0.1  ,  0.1  ,  0.1  ,  0.1  ,
        0.1  ,  0.1  ,  0.1  ,  0.096,  0.092,  0.088,  0.084,  0.08 ,
        0.076,  0.071,  0.071,  0.076,  0.08 ,  0.084,  0.09 ,  0.084,
        0.065,  0.05 ,  0.049,  0.05 ,  0.05 ,  0.05 ,  0.05 ,  0.045,
        0.048,  0.049,  0.044,  0.04 ,  0.04 ,  0.037,  0.035,  0.034,
        0.03 ,  0.03 ,  0.026,  0.027,  0.03 ,  0.025,  0.016,  0.014,
        0.017,  0.021,  0.02 ,  0.009, -0.007, -0.022, -0.033, -0.04 ,
       -0.036, -0.033, -0.025, -0.013, -0.01 , -0.016, -0.003,  0.008,
        0.004,  0.   , -0.004, -0.008, -0.014, -0.03 , -0.05 , -0.051,
       -0.049, -0.051, -0.049, -0.045, -0.045, -0.044, -0.049, -0.037,
        0.   , -0.002, -0.007, -0.004, -0.007, -0.015, -0.015, -0.017,
       -0.023, -0.024, -0.02 , -0.02 , -0.021, -0.018, -0.015, -0.015,
       -0.012, -0.003,  0.   , -0.007, -0.01 , -0.006, -0.007, -0.013,
       -0.014, -0.01 , -0.018, -0.021, -0.036, -0.059, -0.06 , -0.056,
       -0.051, -0.05 , -0.049, -0.045, -0.041, -0.04 , -0.039, -0.034,
       -0.03 , -0.027, -0.013,  0.   ,  0.007,  0.02 ,  0.031,  0.012,
       -0.021, -0.036, -0.03 , -0.029, -0.031, -0.028, -0.025, -0.03 ,
       -0.031, -0.027, -0.025, -0.025, -0.025, -0.025, -0.025, -0.025,
       -0.024, -0.025, -0.04 , -0.061, -0.061, -0.058, -0.075, -0.061,
       -0.043, -0.04 , -0.039, -0.035, -0.035, -0.032, -0.028, -0.006,
        0.04 ,  0.07 ,  0.088,  0.135,  0.208,  0.27 ,  0.329,  0.391,
        0.397,  0.356,  0.325,  0.267,  0.202,  0.169,  0.136,  0.045,
       -0.053, -0.092, -0.1  , -0.113, -0.125, -0.155, -0.197, -0.228,
       -0.244, -0.26 , -0.286, -0.322, -0.323, -0.303, -0.31 , -0.31 ,
       -0.313, -0.315, -0.316, -0.32 , -0.32 , -0.323, -0.325, -0.325,
       -0.33 , -0.332, -0.318, -0.305, -0.289, -0.245, -0.19 , -0.167,
       -0.161, -0.145, -0.115, -0.085, -0.109, -0.126, -0.114, -0.11 ,
       -0.076, -0.033, -0.018, -0.028, -0.035, -0.039, -0.041, -0.037,
       -0.027, -0.015, -0.013, -0.025, -0.03 , -0.024, -0.025, -0.025,
       -0.025, -0.026, -0.032, -0.035, -0.027, -0.022, -0.018, -0.006,
       -0.005, -0.041, -0.026, -0.007, -0.017, -0.015, -0.014, -0.018,
       -0.02 , -0.02 , -0.02 , -0.022, -0.035, -0.008,  0.036,  0.035,
        0.035,  0.035,  0.035,  0.035,  0.035,  0.035,  0.035,  0.035,
        0.035,  0.035,  0.035,  0.033,  0.026,  0.027,  0.045,  0.058,
        0.061,  0.06 ,  0.059,  0.055,  0.054,  0.061,  0.083,  0.102,
        0.1  ,  0.1  ,  0.1  ,  0.102,  0.105,  0.105,  0.105,  0.108,
        0.111,  0.109,  0.105,  0.109,  0.11 ,  0.11 ,  0.11 ,  0.11 ,
        0.114,  0.115,  0.115,  0.115,  0.115,  0.115,  0.112,  0.11 ,
        0.11 ,  0.11 ,  0.114,  0.121,  0.13 ,  0.136,  0.135,  0.134,
        0.137,  0.126,  0.097,  0.075,  0.078,  0.081,  0.08 ,  0.08 ,
        0.08 ,  0.08 ,  0.08 ,  0.094,  0.078,  0.015,  0.016,  0.024,
        0.029,  0.036,  0.035,  0.039,  0.043,  0.046,  0.044,  0.04 ,
        0.036,  0.032,  0.028,  0.025,  0.025,  0.025,  0.025,  0.024,
        0.019,  0.015,  0.015,  0.011,  0.012,  0.015,  0.01 ,  0.01 ,
        0.007,  0.005,  0.004,  0.   ,  0.007, -0.015, -0.023, -0.007,
       -0.005,  0.003,  0.011,  0.019,  0.027,  0.03 ,  0.016, -0.008,
       -0.015, -0.009, -0.01 , -0.006, -0.004, -0.007,  0.007,  0.035,
        0.022, -0.001, -0.002,  0.015,  0.025,  0.008, -0.022,  0.004,
        0.05 ,  0.04 ,  0.039,  0.037,  0.035,  0.035,  0.03 ,  0.027,
        0.048,  0.064,  0.057,  0.055,  0.076,  0.079,  0.073,  0.068,
        0.06 ,  0.06 ,  0.058,  0.05 ,  0.045,  0.045,  0.027, -0.002,
       -0.009,  0.003,  0.01 ,  0.014,  0.021,  0.029,  0.037,  0.04 ,
        0.036,  0.035,  0.033,  0.029,  0.03 ,  0.031,  0.022,  0.01 ,
        0.003, -0.005, -0.013, -0.023, -0.022, -0.013, -0.01 , -0.002,
        0.007,  0.011,  0.01 ,  0.01 ,  0.01 ,  0.007,  0.003, -0.001,
       -0.005, -0.009, -0.013, -0.016, -0.014, -0.01 , -0.01 , -0.009,
       -0.012, -0.015, -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.006, -0.004, -0.007,
       -0.01 , -0.01 , -0.01 , -0.007, -0.004, -0.005, -0.005, -0.005,
       -0.005, -0.003,  0.001,  0.   , -0.011, -0.025, -0.016,  0.02 ,
        0.045,  0.02 , -0.014, -0.034, -0.049, -0.06 , -0.052, -0.046,
       -0.043, -0.039, -0.035, -0.031, -0.027, -0.023, -0.019, -0.015,
       -0.013,  0.007,  0.014,  0.004,  0.005,  0.002, -0.007, -0.009,
       -0.004, -0.005, -0.005, -0.005, -0.005, -0.004,  0.   ,  0.002,
       -0.007,  0.009,  0.022, -0.02 , -0.055, -0.101, -0.095, -0.036,
        0.   ,  0.016,  0.034,  0.056,  0.1  ,  0.17 ,  0.206,  0.217,
        0.243,  0.311,  0.39 ,  0.415,  0.407,  0.378,  0.334,  0.29 ,
        0.249,  0.18 ,  0.103,  0.022, -0.06 , -0.077, -0.104, -0.142,
       -0.165, -0.18 , -0.194, -0.225, -0.265, -0.288, -0.285, -0.285,
       -0.285, -0.285, -0.284, -0.28 , -0.28 , -0.28 , -0.28 , -0.28 ,
       -0.28 , -0.281, -0.275, -0.297, -0.321, -0.3  , -0.287, -0.275,
       -0.253, -0.221, -0.195, -0.205, -0.183, -0.14 , -0.117, -0.115,
       -0.111, -0.106, -0.105, -0.096, -0.07 , -0.047, -0.047, -0.033,
       -0.033, -0.08 , -0.07 , -0.06 , -0.058, -0.055, -0.055, -0.054,
       -0.06 , -0.022,  0.024,  0.005, -0.004, -0.01 , -0.021, -0.032,
       -0.04 , -0.051, -0.034, -0.026, -0.037, -0.04 , -0.043, -0.051,
       -0.04 , -0.015, -0.005, -0.005, -0.006, -0.001,  0.007,  0.02 ,
        0.047,  0.006, -0.026, -0.013, -0.015, -0.019, -0.02 , -0.02 ,
       -0.019, -0.02 , -0.028,  0.002,  0.011,  0.011,  0.055,  0.061,
        0.062,  0.067,  0.071,  0.07 ,  0.054,  0.082,  0.105,  0.099,
        0.1  ,  0.101,  0.097,  0.095,  0.095,  0.095,  0.098,  0.073,
        0.059,  0.073,  0.08 ,  0.084,  0.087,  0.094,  0.102,  0.105,
        0.105,  0.108,  0.112,  0.116,  0.12 ,  0.12 ,  0.123,  0.126,
        0.125,  0.125,  0.129,  0.13 ,  0.13 ,  0.129,  0.125,  0.125,
        0.123,  0.118,  0.114,  0.115,  0.119,  0.12 ,  0.12 ,  0.12 ,
        0.12 ,  0.119,  0.123,  0.111,  0.118,  0.165,  0.16 ,  0.144,
        0.138,  0.134,  0.125,  0.108,  0.099,  0.089,  0.078,  0.07 ,
        0.058,  0.047,  0.047,  0.05 ,  0.045,  0.045,  0.042,  0.039,
        0.041,  0.045,  0.041,  0.037,  0.033,  0.029,  0.025,  0.02 ,
        0.024,  0.022,  0.014,  0.01 ,  0.002, -0.004, -0.006, -0.012,
       -0.015,  0.   ,  0.018,  0.014, -0.012, -0.03 , -0.023, -0.016,
       -0.014, -0.008,  0.   ,  0.004,  0.009,  0.009,  0.004,  0.   ,
       -0.005, -0.005, -0.021, -0.035, -0.025, -0.025, -0.023, -0.018,
       -0.014, -0.01 , -0.01 , -0.009,  0.003,  0.026,  0.045,  0.041,
        0.04 ,  0.038,  0.034,  0.035,  0.035,  0.032,  0.029,  0.03 ,
        0.03 ,  0.026,  0.024,  0.026,  0.023,  0.01 ,  0.002, -0.009,
       -0.021, -0.025, -0.02 , -0.024, -0.026, -0.022, -0.02 , -0.025,
       -0.025, -0.027, -0.018, -0.002,  0.005,  0.016,  0.032,  0.032,
        0.016,  0.005, -0.002, -0.017, -0.03 , -0.038, -0.045, -0.033,
       -0.027, -0.003,  0.022,  0.01 ,  0.005,  0.003, -0.004, -0.011,
       -0.015, -0.019, -0.023, -0.029, -0.037, -0.045, -0.053, -0.061,
       -0.07 , -0.074, -0.065, -0.061, -0.058, -0.051, -0.044, -0.04 ,
       -0.021,  0.003,  0.01 ,  0.003,  0.   , -0.004, -0.008, -0.011,
       -0.019, -0.035, -0.039, -0.045, -0.055, -0.052, -0.035, -0.026,
       -0.019, -0.011, -0.002,  0.01 ,  0.019,  0.02 , -0.01 , -0.045,
       -0.045, -0.044, -0.048, -0.051, -0.048, -0.04 , -0.035, -0.037,
       -0.045, -0.049, -0.04 , -0.032, -0.024, -0.015, -0.009, -0.01 ,
       -0.013, -0.022, -0.025, -0.018, -0.015, -0.023, -0.031, -0.039,
       -0.047, -0.055, -0.063, -0.068, -0.072, -0.076, -0.07 , -0.032,
        0.012,  0.027,  0.018,  0.015,  0.011,  0.006,  0.005,  0.004,
        0.   , -0.004, -0.008, -0.01 , -0.01 , -0.01 , -0.01 , -0.013,
       -0.016, -0.014, -0.02 , -0.046, -0.012,  0.015,  0.003,  0.005,
        0.001,  0.   , -0.002, -0.005, -0.01 , -0.036, -0.039, -0.033,
       -0.036, -0.035, -0.027, -0.024, -0.026, -0.024, -0.02 , -0.02 ,
       -0.018, -0.011, -0.022, -0.055, -0.049, -0.037, -0.033, -0.029,
       -0.025, -0.021, -0.016, -0.017, -0.02 , -0.02 , -0.024, -0.025,
       -0.027, -0.03 , -0.03 , -0.034, -0.035, -0.037, -0.04 , -0.04 ,
       -0.044, -0.045, -0.046, -0.051, -0.05 , -0.031, -0.011, -0.019,
       -0.055, -0.08 , -0.05 , -0.021,  0.004,  0.03 ,  0.05 ,  0.099,
        0.163,  0.226,  0.284,  0.345,  0.419,  0.429,  0.42 ,  0.442,
        0.44 ,  0.344,  0.274,  0.2  ,  0.095,  0.035,  0.035, -0.052,
       -0.128, -0.131, -0.15 , -0.192, -0.246, -0.27 , -0.264, -0.27 ,
       -0.292, -0.325, -0.352, -0.369, -0.38 , -0.373, -0.334, -0.371,
       -0.444, -0.43 , -0.425, -0.422, -0.421, -0.408, -0.36 , -0.314,
       -0.288, -0.273, -0.255, -0.235, -0.218, -0.206, -0.195, -0.181,
       -0.165, -0.151, -0.116, -0.062, -0.034, -0.055, -0.072, -0.083,
       -0.084, -0.078, -0.07 , -0.058, -0.049, -0.04 , -0.036, -0.045,
       -0.045, -0.048, -0.05 , -0.051, -0.055, -0.053, -0.071, -0.082,
       -0.072, -0.055, -0.025, -0.018, -0.018, -0.015, -0.015,  0.011,
        0.043,  0.028, -0.037, -0.085, -0.068, -0.042, -0.03 , -0.006,
        0.01 , -0.066, -0.079, -0.059, -0.05 , -0.025, -0.014,  0.01 ,
        0.035,  0.04 ,  0.035,  0.035,  0.032,  0.03 ,  0.03 ,  0.025,
        0.018,  0.005,  0.   ,  0.007,  0.01 ,  0.007,  0.035,  0.052,
        0.044,  0.045,  0.045,  0.043,  0.051,  0.079,  0.1  ,  0.063,
        0.057,  0.069,  0.071,  0.08 ,  0.084,  0.088,  0.092,  0.097,
        0.105,  0.114,  0.118,  0.124,  0.131,  0.135,  0.143,  0.112,
        0.092,  0.102,  0.1  ,  0.095,  0.098,  0.101,  0.1  ,  0.1  ,
        0.107,  0.118,  0.119,  0.114,  0.115,  0.115,  0.115,  0.115,
        0.115,  0.115,  0.118,  0.127,  0.128,  0.117,  0.11 ,  0.106,
        0.102,  0.097,  0.088,  0.085,  0.103,  0.13 ,  0.128,  0.105,
        0.095,  0.084,  0.068,  0.054,  0.041,  0.03 ,  0.045,  0.058,
        0.06 ,  0.06 ,  0.06 ,  0.06 ,  0.061,  0.056,  0.049,  0.05 ,
        0.047,  0.038,  0.052,  0.07 ,  0.05 ,  0.033,  0.019,  0.001,
       -0.02 , -0.035, -0.028, -0.021, -0.018, -0.015, -0.015, -0.011,
       -0.008, -0.001,  0.006,  0.005,  0.009,  0.013,  0.016,  0.022,
        0.025,  0.01 , -0.006, -0.01 , -0.003,  0.005,  0.009,  0.016,
        0.022,  0.027,  0.035,  0.023,  0.017,  0.01 , -0.004, -0.015,
       -0.023, -0.034, -0.029, -0.011,  0.   ,  0.012,  0.026,  0.029,
        0.024,  0.025,  0.03 ,  0.027,  0.024,  0.026,  0.025,  0.017,
        0.014,  0.015,  0.016,  0.02 ,  0.016,  0.014,  0.017,  0.02 ,
        0.015,  0.014,  0.019,  0.019,  0.014,  0.015,  0.02 ,  0.017,
        0.014,  0.016,  0.02 ,  0.016,  0.014,  0.016,  0.014,  0.01 ,
        0.01 ,  0.01 ,  0.01 ,  0.009,  0.005,  0.005,  0.004,  0.007,
        0.01 ,  0.005,  0.005,  0.005,  0.005,  0.004,  0.   ,  0.   ,
        0.   ,  0.   ,  0.   ,  0.   , -0.005, -0.002,  0.001,  0.   ,
        0.   , -0.004, -0.006, -0.003,  0.   ,  0.   ,  0.   , -0.003,
       -0.006, -0.004,  0.   ,  0.001, -0.003, -0.005, -0.005, -0.005,
        0.   , -0.003, -0.006, -0.005, -0.005, -0.005, -0.005, -0.005,
       -0.005, -0.005, -0.005, -0.004, -0.007, -0.01 , -0.005, -0.005,
       -0.005, -0.004, -0.006, -0.01 , -0.01 , -0.013, -0.016, -0.015,
       -0.015, -0.015, -0.015, -0.015, -0.015, -0.015, -0.019, -0.02 ,
       -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.019, -0.015,
       -0.014, -0.019, -0.019, -0.015, -0.015, -0.015, -0.018, -0.021,
       -0.02 , -0.02 , -0.024, -0.025, -0.025, -0.025, -0.025, -0.033,
       -0.036, -0.034, -0.036, -0.04 , -0.04 , -0.04 , -0.04 , -0.039,
       -0.035, -0.035, -0.035, -0.035, -0.034, -0.03 , -0.026, -0.021,
       -0.02 , -0.019, -0.015, -0.014, -0.019, -0.018, -0.016, -0.02 ,
       -0.016, -0.018, -0.018, -0.015, -0.02 , -0.02 , -0.02 , -0.02 ,
       -0.02 , -0.02 , -0.02 , -0.019, -0.023, -0.014,  0.015,  0.012,
        0.009,  0.01 ,  0.01 ,  0.01 ,  0.005,  0.008,  0.009,  0.004,
        0.005,  0.01 ,  0.007,  0.004,  0.005,  0.005,  0.006,  0.001,
        0.002,  0.005,  0.   , -0.001,  0.004,  0.002, -0.007, -0.015,
       -0.019, -0.02 , -0.02 , -0.02 , -0.015,  0.009,  0.061,  0.115,
        0.171,  0.235,  0.282,  0.379,  0.481,  0.569,  0.64 ,  0.603,
        0.569,  0.51 ,  0.395,  0.285,  0.211,  0.144,  0.095,  0.042,
       -0.04 , -0.093, -0.148, -0.196, -0.228, -0.255, -0.253, -0.242,
       -0.26 , -0.298, -0.32 , -0.346, -0.352, -0.366, -0.389, -0.39 ,
       -0.388, -0.4  , -0.403, -0.393, -0.395, -0.405, -0.391, -0.359,
       -0.327, -0.295, -0.26 , -0.254, -0.267, -0.267, -0.24 , -0.212,
       -0.184, -0.157, -0.136, -0.125, -0.117, -0.109, -0.1  , -0.086,
       -0.07 , -0.069, -0.071, -0.068, -0.065, -0.065, -0.061, -0.057,
       -0.053, -0.049, -0.045, -0.041, -0.036, -0.035, -0.033, -0.025,
       -0.025, -0.025, -0.025, -0.025, -0.025, -0.021, -0.016, -0.015,
       -0.015, -0.015, -0.017, -0.003,  0.008,  0.012,  0.01 , -0.02 ,
       -0.022, -0.013, -0.016, -0.015, -0.011, -0.01 , -0.008, -0.005,
       -0.005,  0.003,  0.009,  0.009,  0.013,  0.03 ,  0.043,  0.046,
        0.01 , -0.029, -0.02 , -0.019, -0.02 , -0.021, -0.018, -0.005,
        0.013,  0.013,  0.009,  0.011,  0.02 ,  0.037,  0.044,  0.047,
        0.051,  0.055,  0.059,  0.063,  0.065,  0.065,  0.07 ,  0.087,
        0.089,  0.084,  0.085,  0.085,  0.084,  0.091,  0.096,  0.095,
        0.1  ,  0.104,  0.108,  0.113,  0.115,  0.11 ,  0.11 ,  0.111,
        0.108,  0.105,  0.105,  0.106,  0.102,  0.1  ,  0.1  ,  0.095,
        0.09 ,  0.09 ,  0.088,  0.085,  0.085,  0.081,  0.079,  0.081,
        0.079,  0.075,  0.075,  0.076,  0.073,  0.07 ,  0.07 ,  0.066,
        0.065,  0.064,  0.058,  0.05 ,  0.05 ,  0.048,  0.042,  0.04 ,
        0.04 ,  0.036,  0.036,  0.031,  0.024,  0.025,  0.026,  0.019,
        0.014,  0.015,  0.015,  0.016,  0.007, -0.005, -0.011, -0.01 ,
       -0.009, -0.014, -0.013, -0.01 , -0.015, -0.016, -0.009, -0.004,
       -0.005,  0.   ,  0.005,  0.005,  0.007,  0.01 ,  0.01 ,  0.014,
        0.018,  0.021,  0.019,  0.02 ,  0.028,  0.031,  0.03 ,  0.03 ,
        0.03 ,  0.03 ,  0.027,  0.024,  0.025,  0.025,  0.025,  0.022,
        0.02 ,  0.02 ,  0.02 ,  0.024,  0.025,  0.026,  0.031,  0.035,
        0.039,  0.04 ,  0.042,  0.045,  0.04 ,  0.039,  0.041,  0.036,
        0.029,  0.03 ,  0.03 ,  0.03 ,  0.029,  0.023,  0.015,  0.012,
        0.001, -0.009, -0.009, -0.005, -0.004, -0.008, -0.01 , -0.01 ,
       -0.01 , -0.01 , -0.013, -0.016, -0.015, -0.015, -0.015, -0.018,
       -0.021, -0.02 , -0.02 , -0.02 , -0.019, -0.022, -0.025, -0.025,
       -0.025, -0.025, -0.027, -0.03 , -0.03 , -0.029, -0.033, -0.035,
       -0.035, -0.04 , -0.044, -0.045, -0.047, -0.051, -0.055, -0.06 ,
       -0.058, -0.053, -0.049, -0.045, -0.041, -0.036, -0.036, -0.033,
       -0.02 , -0.023, -0.031, -0.021, -0.002,  0.   ,  0.001, -0.009,
       -0.019, -0.02 , -0.02 , -0.02 , -0.02 , -0.022, -0.026, -0.025,
       -0.021, -0.02 , -0.02 , -0.021, -0.025, -0.025, -0.025, -0.025,
       -0.025, -0.025, -0.017, -0.011, -0.008, -0.004,  0.   ,  0.004,
        0.007,  0.015,  0.047,  0.11 ,  0.175,  0.234,  0.302,  0.397,
        0.505,  0.578,  0.645,  0.664,  0.595,  0.475,  0.387,  0.326,
        0.26 ,  0.188,  0.12 ,  0.043, -0.023, -0.074, -0.123, -0.165,
       -0.178, -0.187, -0.19 , -0.211, -0.27 , -0.303, -0.333, -0.35 ,
       -0.35 , -0.355, -0.359, -0.364, -0.364, -0.359, -0.355, -0.351,
       -0.348, -0.34 , -0.327, -0.315, -0.292, -0.264, -0.254, -0.263,
       -0.265, -0.245, -0.229, -0.204, -0.166, -0.135, -0.111, -0.086,
       -0.069, -0.064, -0.06 , -0.057, -0.048, -0.044, -0.045, -0.045,
       -0.045, -0.045, -0.045, -0.044, -0.04 , -0.04 , -0.041, -0.037,
       -0.028, -0.025, -0.021, -0.014, -0.007, -0.004,  0.   ,  0.004,
        0.005,  0.005,  0.005,  0.005,  0.005,  0.005,  0.005,  0.006,
        0.005, -0.012, -0.017, -0.014, -0.015, -0.015, -0.015, -0.016,
       -0.012, -0.011, -0.015,  0.001,  0.01 ,  0.01 ,  0.01 ,  0.01 ,
        0.01 ,  0.013,  0.017,  0.021,  0.025,  0.026,  0.023,  0.032,
        0.047,  0.05 ,  0.054,  0.058,  0.061,  0.059,  0.055,  0.055,
        0.052,  0.049,  0.051,  0.055,  0.058,  0.069,  0.079,  0.08 ,
        0.08 ,  0.089,  0.084,  0.083,  0.091,  0.09 ,  0.095,  0.093,
        0.103,  0.115,  0.105,  0.108,  0.111,  0.109,  0.111,  0.115,
        0.115,  0.114,  0.117,  0.12 ,  0.12 ,  0.12 ,  0.119,  0.123,
        0.124,  0.115,  0.111,  0.107,  0.103,  0.099,  0.095,  0.091,
        0.086,  0.085,  0.083,  0.075,  0.076,  0.069,  0.065,  0.063,
        0.055,  0.055,  0.049,  0.045,  0.043,  0.035,  0.039,  0.038,
        0.033,  0.029,  0.025,  0.021,  0.018,  0.008,  0.   ,  0.005,
        0.005,  0.005,  0.003,  0.008,  0.015, -0.018, -0.026, -0.017,
       -0.014, -0.01 , -0.006, -0.004, -0.006, -0.003,  0.005,  0.009,
        0.013,  0.017,  0.021,  0.025,  0.03 ,  0.026,  0.014,  0.011,
        0.02 ,  0.02 ,  0.022,  0.027,  0.031,  0.035,  0.035,  0.038,
        0.04 ,  0.04 ,  0.045,  0.05 ,  0.044,  0.039,  0.04 ,  0.035,
        0.031,  0.026,  0.025,  0.023,  0.015,  0.015,  0.015,  0.015,
        0.015,  0.015,  0.015,  0.015,  0.015,  0.015,  0.015,  0.01 ,
        0.013,  0.016,  0.014,  0.01 ,  0.01 ,  0.007,  0.005,  0.004,
        0.   ,  0.   ,  0.001, -0.003, -0.012, -0.015, -0.015, -0.015,
       -0.015, -0.015, -0.015, -0.015, -0.015, -0.015, -0.015, -0.015,
       -0.007, -0.001,  0.001, -0.01 , -0.03 , -0.027, -0.024, -0.025,
       -0.025, -0.025, -0.021, -0.02 , -0.02 , -0.02 , -0.02 , -0.016,
       -0.015, -0.013, -0.011, -0.015, -0.011, -0.01 , -0.01 , -0.011,
       -0.015, -0.015, -0.015, -0.015, -0.015, -0.015, -0.011, -0.006,
       -0.005, -0.004,  0.   ,  0.004,  0.006,  0.003,  0.   ,  0.   ,
       -0.004, -0.005, -0.007, -0.01 , -0.01 , -0.014, -0.015, -0.017,
       -0.02 , -0.02 , -0.024, -0.025, -0.027, -0.03 , -0.03 , -0.038,
       -0.043, -0.049, -0.056, -0.06 , -0.065, -0.063, -0.073, -0.085,
       -0.075, -0.07 , -0.068, -0.061, -0.053, -0.05 , -0.047, -0.035,
       -0.012,  0.017,  0.045,  0.083,  0.139,  0.198,  0.246,  0.305,
        0.409,  0.5  ,  0.58 ,  0.613,  0.57 ,  0.54 ,  0.449,  0.356,
        0.293,  0.22 ,  0.165,  0.089, -0.011, -0.08 , -0.095, -0.134,
       -0.17 , -0.202, -0.23 , -0.24 , -0.262, -0.299, -0.339, -0.372,
       -0.39 , -0.383, -0.376, -0.374, -0.377, -0.39 , -0.396, -0.387,
       -0.374, -0.361, -0.35 , -0.357, -0.367, -0.353, -0.306, -0.26 ,
       -0.255, -0.249, -0.245, -0.234, -0.2  , -0.171, -0.147, -0.122,
       -0.101, -0.09 , -0.078, -0.068, -0.063, -0.058, -0.05 , -0.054,
       -0.056, -0.054, -0.056, -0.06 , -0.056, -0.058, -0.06 , -0.053,
       -0.05 , -0.067, -0.066, -0.056, -0.055, -0.055, -0.051, -0.05 ,
       -0.048, -0.045, -0.045, -0.041, -0.037, -0.033, -0.03 , -0.03 ,
       -0.026, -0.025, -0.023, -0.02 , -0.02 , -0.012, -0.006, -0.004,
       -0.007, -0.015, -0.012, -0.004,  0.002,  0.006,  0.01 ,  0.01 ,
        0.013,  0.016,  0.015,  0.015,  0.015,  0.015,  0.015,  0.016,
        0.02 ,  0.02 ,  0.023,  0.025,  0.026,  0.03 ,  0.03 ,  0.031,
        0.042,  0.051,  0.045,  0.043,  0.057,  0.069,  0.071,  0.075,
        0.079,  0.08 ,  0.082,  0.086,  0.085,  0.08 ,  0.086,  0.091,
        0.09 ,  0.095,  0.1  ,  0.1  ,  0.102,  0.106,  0.105,  0.104,
        0.109,  0.109,  0.104,  0.1  ,  0.1  ,  0.097,  0.094,  0.096,
        0.095,  0.087,  0.084,  0.086,  0.084,  0.08 ,  0.08 ,  0.08 ,
        0.079,  0.081,  0.085,  0.081,  0.08 ,  0.078,  0.075,  0.075,
        0.071,  0.067,  0.063,  0.058,  0.05 ,  0.046,  0.042,  0.039,
        0.04 ,  0.04 ,  0.036,  0.035,  0.033,  0.031,  0.035,  0.031,
        0.03 ,  0.028,  0.025,  0.025,  0.021,  0.017,  0.013,  0.01 ,
        0.01 ,  0.006,  0.005,  0.005,  0.005,  0.005,  0.005,  0.005,
        0.005,  0.004,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,
        0.   ,  0.001, -0.002, -0.005, -0.005, -0.005, -0.005, -0.005,
       -0.004,  0.   ,  0.   ,  0.003,  0.007,  0.011,  0.015,  0.015,
        0.018,  0.02 ,  0.022,  0.03 ,  0.03 ,  0.03 ,  0.029,  0.032,
        0.04 ,  0.032,  0.026,  0.024,  0.018,  0.01 ,  0.006,  0.001,
        0.   ,  0.007,  0.01 , -0.011, -0.014, -0.009, -0.01 , -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.005, -0.008, -0.011,
       -0.01 , -0.01 , -0.006, -0.004, -0.007, -0.01 , -0.005, -0.004,
       -0.008, -0.011, -0.009, -0.005, -0.009, -0.011, -0.01 , -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.009, -0.014,
       -0.014, -0.009, -0.01 , -0.014, -0.015, -0.015, -0.015, -0.015,
       -0.02 , -0.017, -0.016, -0.02 , -0.02 , -0.024, -0.023, -0.017,
       -0.015, -0.015, -0.01 , -0.013, -0.013, -0.01 , -0.015, -0.011,
       -0.009, -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.01 ,
       -0.01 , -0.014, -0.018, -0.023, -0.025, -0.02 , -0.019, -0.021,
       -0.016, -0.019, -0.04 , -0.037, -0.035, -0.033, -0.029, -0.03 ,
       -0.028, -0.012, -0.005, -0.01 , -0.005, -0.005, -0.005, -0.005,
       -0.005, -0.005, -0.005, -0.006, -0.003,  0.   , -0.005, -0.005,
       -0.005, -0.005, -0.005, -0.005, -0.006, -0.002, -0.016, -0.029,
       -0.015, -0.018, -0.021, -0.02 , -0.02 , -0.02 , -0.021, -0.014,
        0.009,  0.044,  0.085,  0.148,  0.212,  0.282,  0.367,  0.455,
        0.538,  0.624,  0.634,  0.587,  0.55 ,  0.439,  0.345,  0.291,
        0.232,  0.15 ,  0.072, -0.021, -0.067, -0.085, -0.145, -0.179,
       -0.204, -0.207, -0.21 , -0.245, -0.275, -0.324, -0.351, -0.343,
       -0.34 , -0.341, -0.336, -0.338, -0.356, -0.375, -0.372, -0.364,
       -0.37 , -0.365, -0.33 , -0.309, -0.289, -0.261, -0.243, -0.25 ,
       -0.256, -0.242, -0.22 , -0.199, -0.17 , -0.141, -0.122, -0.107,
       -0.092, -0.085, -0.081, -0.077, -0.072, -0.062, -0.05 , -0.039,
       -0.051, -0.064, -0.065, -0.065, -0.061, -0.059, -0.061, -0.059,
       -0.05 , -0.041, -0.037, -0.032, -0.023, -0.015, -0.011, -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.011, -0.009,  0.   ,
        0.004,  0.008,  0.012,  0.016,  0.02 ,  0.022,  0.004, -0.006,
        0.001,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,  0.   ,
        0.   ,  0.   ,  0.001,  0.005,  0.005,  0.008,  0.01 ,  0.01 ,
        0.01 ,  0.008,  0.028,  0.045,  0.045,  0.05 ,  0.055,  0.054,
        0.058,  0.066,  0.07 ,  0.074,  0.075,  0.075,  0.075,  0.075,
        0.083,  0.088,  0.094,  0.101,  0.1  ,  0.104,  0.109,  0.108,
        0.105,  0.11 ,  0.115,  0.112,  0.111,  0.116,  0.12 ,  0.12 ,
        0.12 ,  0.12 ,  0.121,  0.125,  0.125,  0.124,  0.127,  0.131,
        0.13 ,  0.126,  0.123,  0.116,  0.109,  0.105,  0.097,  0.091,
        0.09 ,  0.09 ,  0.09 ,  0.095,  0.092,  0.091,  0.096,  0.095,
        0.083,  0.073,  0.067,  0.057,  0.045,  0.036,  0.032,  0.028,
        0.025,  0.025,  0.025,  0.022,  0.019,  0.02 ,  0.02 ,  0.02 ,
        0.02 ,  0.02 ,  0.019,  0.015,  0.015,  0.016,  0.013,  0.009,
        0.01 ,  0.015,  0.012,  0.009,  0.011,  0.015,  0.011,  0.01 ,
        0.01 ,  0.011,  0.015,  0.011,  0.009,  0.012,  0.015,  0.015,
        0.015,  0.015,  0.014,  0.009,  0.005,  0.005,  0.005,  0.005,
        0.005,  0.005,  0.013,  0.02 ,  0.016,  0.009,  0.01 ,  0.007,
        0.001,  0.017,  0.037,  0.03 ,  0.03 ,  0.027,  0.027,  0.03 ,
        0.025,  0.025,  0.025,  0.025,  0.025,  0.025,  0.021,  0.02 ,
        0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.017,  0.014,  0.016,  0.02 ,
        0.02 ,  0.02 ,  0.019,  0.021,  0.025,  0.021,  0.02 ,  0.02 ,
        0.02 ,  0.02 ,  0.009, -0.005, -0.013, -0.016, -0.02 , -0.02 ,
       -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.023, -0.026, -0.024,
       -0.02 , -0.02 , -0.021, -0.018, -0.014, -0.015, -0.019, -0.025,
       -0.022, -0.014, -0.015, -0.016, -0.012, -0.01 , -0.009, -0.005,
       -0.005, -0.002,  0.   ,  0.001,  0.   , -0.013, -0.016, -0.015,
       -0.015, -0.015, -0.015, -0.016, -0.013, -0.01 , -0.01 , -0.01 ,
       -0.01 , -0.01 , -0.011, -0.015, -0.019, -0.02 , -0.02 , -0.02 ,
       -0.02 , -0.02 , -0.019, -0.022, -0.025, -0.025, -0.025, -0.025,
       -0.025, -0.024, -0.02 , -0.015, -0.018, -0.019, -0.015, -0.015,
       -0.011, -0.01 , -0.009, -0.004,  0.   ,  0.   ,  0.001, -0.002,
       -0.005, -0.005, -0.01 , -0.006, -0.007,  0.01 ,  0.075,  0.136,
        0.192,  0.265,  0.351,  0.44 ,  0.541,  0.62 ,  0.628,  0.601,
        0.575,  0.464,  0.372,  0.308,  0.245,  0.18 ,  0.097,  0.014,
       -0.032, -0.059, -0.105, -0.144, -0.191, -0.202, -0.192, -0.22 ,
       -0.247, -0.288, -0.327, -0.34 , -0.335, -0.339, -0.342, -0.35 ,
       -0.354, -0.34 , -0.331, -0.333, -0.351, -0.357, -0.325, -0.299,
       -0.286, -0.256, -0.227, -0.235, -0.237, -0.221, -0.2  , -0.179,
       -0.15 , -0.125, -0.104, -0.087, -0.071, -0.055, -0.042, -0.036,
       -0.033, -0.029, -0.025, -0.016, -0.018, -0.017, -0.008, -0.005,
       -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.003,
        0.001,  0.   , -0.008, -0.013, -0.017, -0.021, -0.02 , -0.019,
       -0.029, -0.039, -0.039, -0.035, -0.035, -0.033, -0.028, -0.025,
       -0.025, -0.026, -0.019, -0.012, -0.01 , -0.01 ,  0.002,  0.01 ,
        0.01 ,  0.011,  0.015,  0.01 ,  0.014,  0.012,  0.012,  0.025,
        0.025,  0.028,  0.029,  0.024,  0.025,  0.037,  0.043,  0.049,
        0.056,  0.055,  0.059,  0.06 ,  0.062,  0.065,  0.065,  0.077,
        0.084,  0.085,  0.085,  0.085,  0.085,  0.084,  0.087,  0.09 ,
        0.09 ,  0.094,  0.095,  0.096,  0.101,  0.105,  0.109,  0.116,
        0.122,  0.126,  0.135,  0.144,  0.145,  0.147,  0.151,  0.15 ,
        0.146,  0.145,  0.144,  0.139,  0.135,  0.131,  0.13 ,  0.129,
        0.124,  0.12 ,  0.116,  0.115,  0.114,  0.109,  0.105,  0.101,
        0.094,  0.088,  0.083,  0.075,  0.071,  0.067,  0.063,  0.06 ,
        0.06 ,  0.056,  0.051,  0.05 ,  0.05 ,  0.05 ,  0.046,  0.041,
        0.04 ,  0.039,  0.035,  0.035,  0.036,  0.034,  0.029,  0.025,
        0.025,  0.022,  0.019,  0.021,  0.02 ,  0.012,  0.009,  0.01 ,
        0.01 ,  0.01 ,  0.011,  0.006,  0.006,  0.011,  0.01 ,  0.01 ,
        0.009,  0.012,  0.015,  0.01 ,  0.01 ,  0.01 ,  0.009,  0.011,
        0.015,  0.011,  0.009,  0.01 ,  0.01 ,  0.01 ,  0.018,  0.027,
        0.032,  0.036,  0.04 ,  0.044,  0.046,  0.041,  0.033,  0.03 ,
        0.03 ,  0.03 ,  0.03 ,  0.03 ,  0.03 ,  0.03 ,  0.027,  0.024,
        0.025,  0.025,  0.025,  0.025,  0.025,  0.025,  0.025,  0.021,
        0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.02 ,
        0.02 ,  0.016,  0.015,  0.013,  0.009,  0.01 ,  0.011,  0.006,
        0.006,  0.011,  0.01 ,  0.01 ,  0.01 ,  0.01 ,  0.009,  0.005,
        0.005,  0.005,  0.005,  0.005,  0.005,  0.   ,  0.003,  0.006,
        0.005,  0.005,  0.005,  0.006,  0.001,  0.004,  0.025,  0.022,
        0.019,  0.02 ,  0.02 ,  0.02 ,  0.016,  0.015,  0.015,  0.015,
        0.015,  0.015,  0.015,  0.015,  0.014,  0.01 ,  0.01 ,  0.01 ,
        0.01 ,  0.01 ,  0.01 ,  0.01 ,  0.01 ,  0.01 ,  0.01 ,  0.01 ,
        0.01 ,  0.009,  0.012,  0.015,  0.015,  0.016,  0.012,  0.026,
        0.03 , -0.005, -0.003,  0.001,  0.   ,  0.   ,  0.   ,  0.004,
        0.009,  0.025,  0.061,  0.115,  0.184,  0.243,  0.3  ,  0.385,
        0.49 ,  0.566,  0.644,  0.641,  0.57 ,  0.515,  0.418,  0.344,
        0.282,  0.204,  0.13 ,  0.084,  0.01 , -0.06 , -0.108, -0.16 ,
       -0.2  , -0.238, -0.252, -0.243, -0.245, -0.267, -0.304, -0.33 ,
       -0.336, -0.335, -0.33 , -0.335, -0.343, -0.345, -0.35 , -0.362,
       -0.37 , -0.368, -0.355, -0.33 , -0.31 , -0.29 , -0.27 , -0.249,
       -0.23 , -0.219, -0.195, -0.166, -0.146, -0.13 , -0.114, -0.098,
       -0.081, -0.067, -0.06 , -0.052, -0.047, -0.042, -0.033, -0.025,
       -0.02 , -0.02 , -0.018, -0.015, -0.015, -0.015, -0.013, -0.007,
       -0.006, -0.01 , -0.007, -0.001,  0.   ,  0.   ,  0.   , -0.004,
       -0.005, -0.005, -0.005, -0.005, -0.005, -0.008, -0.011, -0.01 ,
       -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.01 , -0.009, -0.016,
       -0.023, -0.025, -0.02 , -0.007, -0.004, -0.005, -0.005, -0.005,
       -0.001,  0.001, -0.001,  0.002,  0.01 ,  0.014,  0.017,  0.023,
        0.015, -0.005,  0.014,  0.026,  0.024,  0.027,  0.035,  0.035,
        0.036,  0.045,  0.049,  0.045,  0.069,  0.084,  0.085,  0.086,
        0.09 ,  0.094,  0.099,  0.1  ,  0.102,  0.11 ,  0.11 ,  0.112,
        0.118,  0.119,  0.115,  0.116,  0.111,  0.115,  0.127,  0.13 ,
        0.138,  0.143,  0.149,  0.156,  0.16 ,  0.165,  0.163,  0.157,
        0.155,  0.155,  0.147,  0.144,  0.146,  0.143,  0.135,  0.131,
        0.125,  0.114,  0.103,  0.095,  0.087,  0.078,  0.073,  0.068,
        0.06 ,  0.052,  0.047,  0.042,  0.033,  0.025,  0.021,  0.014,
        0.008,  0.003, -0.005, -0.01 , -0.007, -0.006, -0.011, -0.01 ,
       -0.009, -0.014, -0.013, -0.01 , -0.01 , -0.006, -0.004, -0.005,
       -0.004,  0.   ,  0.004,  0.005,  0.004,  0.006,  0.01 ,  0.01 ,
        0.012,  0.017,  0.02 ,  0.02 ,  0.02 ,  0.02 ,  0.022,  0.026,
        0.025,  0.021,  0.019,  0.021,  0.019,  0.015,  0.015,  0.011,
        0.013,  0.022,  0.025,  0.022,  0.016,  0.033,  0.049,  0.03 ,
        0.025,  0.019,  0.013,  0.009,  0.005,  0.009,  0.007,  0.005,
        0.004,  0.   ,  0.   , -0.003, -0.007, -0.011, -0.015, -0.019,
       -0.023, -0.027, -0.031, -0.035, -0.035, -0.035, -0.035, -0.035,
       -0.035, -0.039, -0.04 , -0.04 , -0.04 , -0.04 , -0.041, -0.037,
       -0.05 , -0.066, -0.06 , -0.06 , -0.057, -0.054, -0.055, -0.055,
       -0.055, -0.056, -0.053, -0.05 , -0.05 , -0.045, -0.048, -0.049,
       -0.044, -0.045, -0.046, -0.041, -0.041, -0.046, -0.045, -0.045,
       -0.045, -0.044, -0.039, -0.035, -0.035, -0.035, -0.035, -0.035,
       -0.035, -0.031, -0.03 , -0.03 , -0.03 , -0.03 , -0.03 , -0.027,
       -0.023, -0.02 , -0.02 , -0.02 , -0.02 , -0.02 , -0.019, -0.015,
       -0.015, -0.016, -0.013, -0.01 , -0.01 , -0.009, -0.015, -0.025,
       -0.03 , -0.025, -0.02 , -0.024, -0.023, -0.02 , -0.025, -0.021,
       -0.019, -0.02 , -0.02 , -0.02 , -0.02 , -0.021, -0.018, -0.015,
       -0.015, -0.01 , -0.016, -0.02 , -0.021, -0.03 , -0.031, -0.029,
       -0.032, -0.035, -0.035, -0.035, -0.032, -0.028, -0.024, -0.02 ,
       -0.02 , -0.017, -0.015, -0.014, -0.01 , -0.009, -0.014, -0.014,
       -0.009, -0.01 , -0.015, -0.012, -0.01 , -0.009, -0.005, -0.001,
        0.004,  0.005,  0.007,  0.015,  0.015,  0.017,  0.022,  0.026,
        0.03 ,  0.03 ,  0.027,  0.022,  0.02 ,  0.02 ,  0.011,  0.012,
        0.016,  0.014,  0.015,  0.02 ,  0.014,  0.009,  0.01 ,  0.01 ,
        0.006,  0.005,  0.005,  0.005,  0.005,  0.001,  0.   ,  0.   ,
        0.   ,  0.   , -0.004, -0.006, -0.004, -0.006, -0.01 , -0.009,
       -0.016, -0.023, -0.025, -0.025, -0.025, -0.025, -0.025, -0.024,
       -0.02 , -0.016, -0.012, -0.007, -0.006, -0.015, -0.024, -0.022,
       -0.02 , -0.019, -0.015, -0.013,  0.012,  0.046,  0.08 ,  0.13 ,
        0.2  ,  0.283,  0.367,  0.46 ,  0.565,  0.64 ,  0.623,  0.587,
        0.533,  0.415,  0.339,  0.283,  0.211,  0.141,  0.085, -0.006,
       -0.056, -0.089, -0.136, -0.175, -0.195, -0.183, -0.191, -0.229,
       -0.255, -0.282, -0.314, -0.33 , -0.33 , -0.335, -0.339, -0.343,
       -0.346, -0.344, -0.335, -0.323, -0.345, -0.351, -0.323, -0.305,
       -0.29 , -0.263, -0.242, -0.233, -0.225, -0.213, -0.202, -0.184,
       -0.159, -0.14 , -0.132, -0.122, -0.109, -0.097, -0.085, -0.073,
       -0.06 , -0.052, -0.05 , -0.05 , -0.042, -0.04 , -0.039, -0.034,
       -0.03 , -0.029, -0.033, -0.035, -0.035, -0.035, -0.026, -0.025,
       -0.022, -0.013, -0.01 , -0.01 , -0.011, -0.007,  0.002,  0.   ,
       -0.013, -0.014, -0.007, -0.005, -0.005,  0.002, -0.019, -0.03 ,
       -0.018, -0.015, -0.007, -0.002,  0.004,  0.011,  0.015,  0.019,
        0.02 ,  0.022,  0.026,  0.025,  0.024,  0.027,  0.017,  0.013,
        0.035,  0.041,  0.039,  0.042,  0.045,  0.045,  0.049,  0.055,
        0.066,  0.078,  0.09 ,  0.102,  0.11 ,  0.108,  0.105,  0.105,
        0.101,  0.096,  0.095,  0.095,  0.09 ,  0.085,  0.087,  0.092,
        0.096,  0.1  ,  0.104,  0.108,  0.11 ,  0.11 ,  0.11 ,  0.11 ,
        0.113,  0.116,  0.115,  0.115,  0.119,  0.12 ,  0.12 ,  0.12 ,
        0.12 ,  0.12 ,  0.12 ,  0.121,  0.126,  0.13 ,  0.129,  0.134,
        0.132,  0.124,  0.125,  0.126,  0.122,  0.119,  0.12 ,  0.12 ,
        0.116,  0.113,  0.106,  0.108,  0.125,  0.118,  0.108,  0.103,
        0.098,  0.09 ,  0.086,  0.083,  0.076,  0.069,  0.065,  0.061,
        0.057,  0.053,  0.049,  0.045,  0.046,  0.039,  0.034,  0.035,
        0.03 ,  0.026,  0.022,  0.017,  0.016,  0.015, -0.006, -0.01 ,
       -0.002,  0.   ,  0.   ,  0.   ,  0.   ,  0.001,  0.006,  0.01 ,
        0.006,  0.005,  0.003,  0.   ,  0.005,  0.005,  0.009,  0.007,
       -0.002, -0.005,  0.001,  0.019,  0.025,  0.02 ,  0.025,  0.026,
        0.021,  0.022,  0.025,  0.025,  0.037,  0.041,  0.04 ,  0.039,
        0.035,  0.039,  0.041,  0.038,  0.035,  0.04 ,  0.041,  0.036,
        0.036,  0.041,  0.04 ,  0.036,  0.035,  0.035,  0.035,  0.035,
        0.035,  0.032,  0.029,  0.03 ,  0.03 ,  0.026,  0.025,  0.025,
        0.025,  0.02 ,  0.01 ,  0.017,  0.031,  0.035,  0.03 ,  0.03 ,
        0.031,  0.028,  0.024,  0.025,  0.033,  0.038,  0.043,  0.052,
        0.055,  0.047,  0.045,  0.044,  0.039,  0.035,  0.03 ,  0.031,
        0.025,  0.013,  0.01 ,  0.007, -0.001, -0.008, -0.011, -0.015,
       -0.02 , -0.017, -0.015, -0.014, -0.01 , -0.01 , -0.009, -0.012,
       -0.015, -0.01 , -0.006, -0.005, -0.005, -0.005, -0.005, -0.005,
       -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.005,
       -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.005, -0.008,
       -0.011, -0.01 , -0.01 , -0.01 , -0.007, -0.005, -0.005, -0.005,
       -0.01 , -0.007, -0.004, -0.005, -0.005, -0.005, -0.002,  0.001,
       -0.001, -0.005, -0.005, -0.005, -0.003,  0.   ,  0.   ,  0.   ,
       -0.001,  0.002,  0.005,  0.   , -0.004, -0.008, -0.012, -0.016,
       -0.015, -0.011, -0.007, -0.003,  0.   ,  0.   ,  0.   , -0.003,
       -0.005, -0.005, -0.01 , -0.015, -0.015, -0.017, -0.02 , -0.02 ,
       -0.028, -0.031, -0.03 , -0.03 , -0.03 , -0.03 , -0.027, -0.025,
       -0.024, -0.02 , -0.019, -0.024, -0.023, -0.02 , -0.02 , -0.016,
       -0.014, -0.016, -0.014, -0.01 , -0.01 , -0.008, -0.002, -0.009,
       -0.025, -0.017, -0.014, -0.014, -0.009, -0.005,  0.   , -0.001,
        0.004,  0.011,  0.01 ,  0.014,  0.014,  0.019,  0.026,  0.025,
        0.028,  0.034,  0.033,  0.022,  0.015,  0.019,  0.017,  0.017,
        0.019,  0.015,  0.019,  0.017,  0.017,  0.019,  0.015,  0.019,
        0.017,  0.016,  0.02 ,  0.02 ,  0.024,  0.026,  0.022,  0.021,
        0.025,  0.021,  0.019,  0.021,  0.019,  0.015,  0.015,  0.015,
        0.015,  0.015,  0.015,  0.015,  0.012,  0.009,  0.01 ,  0.01 ,
        0.005,  0.007, -0.005, -0.021, -0.015, -0.015, -0.012, -0.01 ,
       -0.009, -0.005, -0.005, -0.005, -0.004, -0.006, -0.01 , -0.006,
       -0.008, -0.01 , -0.012, -0.025, -0.031, -0.021, -0.012,  0.01 ,
        0.07 ,  0.139,  0.198,  0.254,  0.334,  0.435,  0.514,  0.606,
        0.633,  0.616,  0.61 ,  0.481,  0.371,  0.316,  0.274,  0.195,
        0.04 ,  0.004, -0.022, -0.091, -0.105, -0.125, -0.141, -0.149,
       -0.158, -0.185, -0.236, -0.249, -0.243, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245,
       -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245, -0.245};



double        features[] = {};
double        ndata[5000]   = {0.0};
int           lag = 5000;
int           sizeOfData = 5000;

float   mean, var;

double millisStart, millisEnd;

int raw_feature_get_data(size_t offset, size_t length, float *out_ptr) {
    memcpy(out_ptr, features + offset, length * sizeof(float));
    return 0;
}

// -------------------------------
// instancing functions
void print_inference_result(ei_impulse_result_t result);
void calcMean(void);
void calcVar(void);
void norm(void);
void atc(void);

// -------------------------------
// program setup
void setup()
{
    Serial.begin(115200);

    while (!Serial);
    Serial.println("STARTING...");

    // calculate necessary values
    calcMean();
    calcVar();
    norm();

    // print the starting time
    millisStart = millis();
    Serial.print("Program started at:");
    Serial.print(millisStart);
    Serial.println("ms");

    // calculate the autocorrelation
    atc();
}


void loop()
{
    ei_printf("ECG Autocorrelation 500Hz - ");

/*     if (sizeof(features) / sizeof(double) != EI_CLASSIFIER_DSP_INPUT_FRAME_SIZE) {
        ei_printf("The size of your 'features' array is not correct. Expected %lu items, but had %lu\n",
            EI_CLASSIFIER_DSP_INPUT_FRAME_SIZE, sizeof(features) / sizeof(double));
        delay(1000);
        return;
    } */

    ei_impulse_result_t result = { 0 };

    // the features are stored into flash, and we don't want to load everything into RAM
    signal_t features_signal;
    features_signal.total_length = sizeof(features) / sizeof(features[0]);
    features_signal.get_data = &raw_feature_get_data;

    // invoke the impulse
    EI_IMPULSE_ERROR res = run_classifier(&features_signal, &result, false /* debug */);
    if (res != EI_IMPULSE_OK) {
        ei_printf("ERR: Failed to run classifier (%d)\n", res);
        return;
    }

    // print inference return code
    ei_printf("run_classifier returned: %d\r\n", res);
    print_inference_result(result);

    delay(1000);
}

void print_inference_result(ei_impulse_result_t result) {

    // Print how long it took to perform inference
    ei_printf("Timing: DSP %d ms, inference %d ms, anomaly %d ms\r\n",
            result.timing.dsp,
            result.timing.classification,
            result.timing.anomaly);

    // Print the prediction results (object detection)
#if EI_CLASSIFIER_OBJECT_DETECTION == 1
    ei_printf("Object detection bounding boxes:\r\n");
    for (uint32_t i = 0; i < result.bounding_boxes_count; i++) {
        ei_impulse_result_bounding_box_t bb = result.bounding_boxes[i];
        if (bb.value == 0) {
            continue;
        }
        ei_printf("  %s (%f) [ x: %u, y: %u, width: %u, height: %u ]\r\n",
                bb.label,
                bb.value,
                bb.x,
                bb.y,
                bb.width,
                bb.height);
    }

    // Print the prediction results (classification)
#else
    ei_printf("Predictions:\r\n");
    for (uint16_t i = 0; i < EI_CLASSIFIER_LABEL_COUNT; i++) {
        ei_printf("  %s: ", ei_classifier_inferencing_categories[i]);
        ei_printf("%.5f\r\n", result.classification[i].value);
    }
#endif

    // Print anomaly result (if it exists)
#if EI_CLASSIFIER_HAS_ANOMALY == 1
    ei_printf("Anomaly prediction: %.3f\r\n", result.anomaly);
#endif

}

// function to calculate the mean
void calcMean(void)
{
    mean = 0;

    for (int i = 0; i < sizeOfData; i++)
    {
        mean += data[i];
    }
    mean = mean / sizeOfData;
    Serial.print("mean = ");
    Serial.println(mean, 8);
}

// function to calculate the variance
void calcVar(void)
{
    var = 0;

    for (int i = 0; i < sizeOfData; i++)
    {
        var += ((data[i] - mean) * (data[i] - mean)) / sizeOfData;
    }
    Serial.print("var = ");
    Serial.println(var, 8);
}

// function to normnalize the data
void norm(void)
{
    for (int i = 0; i < sizeOfData; i++)
    {
        ndata[i] = data[i] - mean;
    }
}

void atc(void)
{
  // lag sized loop
    for (int l = 0; l < lag; l++)
    {
        double c = 1.0, sum = 0.0;
        double tmp = 0.0;

        if (l > 0)
        {
            for (int i = l; i < (sizeOfData - 1); i++)
            {
                // calculate the product point by point
                tmp += (ndata[i] * ndata[i - l]);
            }
            c = tmp / sizeOfData / var;
        }

        features[l] = c;

        Serial.print("features[");
        Serial.print(l);
        Serial.print("] = ");
        Serial.println(features[l], 8);
    }

    millisEnd = millis();
    Serial.print("Program ends at:");
    Serial.print(millisEnd);
    Serial.println("ms");

    Serial.print("Autocorrelation execution time:");
    Serial.print(millisEnd - millisStart);
    Serial.println("ms");
}